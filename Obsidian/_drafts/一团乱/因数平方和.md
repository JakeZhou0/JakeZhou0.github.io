## é—®é¢˜æè¿°

è®° $f(x)$ ä¸º $x$ çš„æ‰€æœ‰å› æ•°çš„å¹³æ–¹çš„å’Œã€‚ä¾‹å¦‚: $f(12) = 1^2 + 2^2 + 3^2 + 4^2 + 6^2 + 12^2 = 169$

å®šä¹‰ $g(n) = \sum_{i=1}^n f(i)$ ã€‚ç»™å®š $n$ï¼Œæ±‚ $g(n)$ é™¤ä»¥ $10^9+7^{10}+7$ çš„ä½™æ•°ã€‚

## è¾“å…¥æ ¼å¼

è¾“å…¥ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ­£æ•´æ•° $n$ã€‚

## è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆ $g(n)$ é™¤ä»¥ $10^9+7^{10}+7$ çš„ä½™æ•°ã€‚

## æ ·ä¾‹è¾“å…¥

```
100000
```

## æ ·ä¾‹è¾“å‡º

```
680584257
```

## è¯´æ˜

- å¯¹äº 20% çš„è¯„æµ‹ç”¨ä¾‹, $nâ‰¤10^5$ã€‚
- å¯¹äº 30% çš„è¯„æµ‹ç”¨ä¾‹, $nâ‰¤10^7$ã€‚
- å¯¹äºæ‰€æœ‰è¯„æµ‹ç”¨ä¾‹, $1â‰¤nâ‰¤10^9$ã€‚

## ç›¸å…³æ ‡ç­¾

#å½’æ¡£/ğŸ“¦/é€†å…ƒ #å½’æ¡£/ğŸ“¦/æ•°è®ºåˆ†å—

## è§£é¢˜æ€è·¯

%% è¿™ä¸ªé¢˜ç›®å¯ä»¥è€ƒè™‘ä½¿ç”¨é€†å…ƒçš„ç›¸å…³çŸ¥è¯†æ¥è§£å†³ã€‚ç”±äºæ±‚çš„æ˜¯ $g(n)$ é™¤ä»¥ä¸€ä¸ªæ¨¡æ•°çš„ä½™æ•°ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ä½¿ç”¨è´¹é©¬/æ¬§æ‹‰å®šç†æ¥æ±‚è§£ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ Java å®ç°çš„ä»£ç å’Œæ€è·¯è§£é‡Šï¼š

```java
import java.io.*;
import java.util.*;

public class Main {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        PrintWriter pw = new PrintWriter(System.out);
        StringTokenizer st = new StringTokenizer(br.readLine());

        int n = Integer.parseInt(st.nextToken());
        int mod = (int) (1e9 + 7 + 7);

        int[] primes = sieve(10000000);
        int[] mu = new int[primes.length];
        mu[0] = -1;
        int[] mu_sum = new int[primes.length];
        mu_sum[0] = 0;

        int[] pow2 = new int[primes.length];
        pow2[0] = 1;

        for (int i = 1; i < primes.length; i++) {
            int p = primes[i];
            mu[i] = -mu[i - 1];
            mu_sum[i] = mu_sum[i - 1] + mu[i];
            pow2[i] = pow2[i - 1] * 2 % mod;
        }

        for (int i = 0; i < primes.length; i++) {
            int p = primes[i];
            int inv = pow(p, mod - 2, mod);
            int cur = 0;
            for (int j = i;; j++) {
                int q = primes[j];
                if (q * p > n) break;
                cur = (int) ((long) cur + mu[j] * (q * p) % mod * pow2[j] % mod * p % mod * inv % mod);
                if (cur >= mod) cur -= mod;
            }
            for (int j = i;; j++) {
                int q = primes[j];
                if (q * p * p > n) break;
                cur = (int) ((long) cur + mu[j] * (q * p * p) % mod * pow2[j] % mod * p % mod * inv % mod);
                if (cur >= mod) cur -= mod;
            }
            for (int j = 0; j <= i; j++) {
                int q = primes[j];
                if (q * p * p > n) break;
                cur = (int) ((long) cur + mu[j] * (q * p * p) % mod * pow2[j] % mod * q % mod * inv % mod);
                if (cur >= mod) cur -= mod;
            }
            pw.print(cur);
            pw.print(mu_sum[i] == 0 ? "" : "+");
        }
        pw.println();
        pw.close();
    }

    static int[] sieve(int n) {
        boolean[] isPrime = new boolean[n + 1];
        Arrays.fill(isPrime, true);
        isPrime[0] = false;
        isPrime[1] = false;
        int[] primes = new int[n + 1];
        int cnt = 0;
        for (int i = 2; i <= n; i++) {
            if (isPrime[i]) {
                primes[cnt++] = i;
                for (int j = i * i; j <= n; j += i) {
                    isPrime[j] = false;
                }
            }
        }
        return Arrays.copyOf(primes, cnt);
    }

    static int pow(int a, int b, int mod) {
        int ans = 1;
        while (b > 0) {
            if ((b & 1) == 1) ans = (int) ((long) ans * a % mod);
            a = (int) ((long) a * a % mod);
            b >>= 1;
        }
        return ans;
    }
}
```

æ€è·¯è§£é‡Šï¼š

1. é¦–å…ˆä½¿ç”¨ç­›æ³•æ±‚å‡º $10^7$ ä»¥å†…çš„æ‰€æœ‰ç´ æ•°ï¼Œå¹¶é¢„å¤„ç†å‡ºè«æ¯”ä¹Œæ–¯å‡½æ•°çš„å‰ç¼€å’Œ `mu_sum`ï¼Œä»¥åŠ $2$ çš„å¹‚æ¬¡å‰ç¼€å’Œ `pow2`ã€‚
2. æšä¸¾æ¯ä¸ªç´ æ•° $p$ï¼Œè®¡ç®— $p$ çš„æ¨¡é€†å…ƒ `inv`ã€‚
3. åˆ†åˆ«æšä¸¾ $p$ã€$p^2$ å’Œ $p^2$ çš„å€æ•°ï¼Œè®¡ç®—è´¡çŒ®ï¼Œå¹¶ç´¯åŠ ç­”æ¡ˆã€‚è¿™é‡Œéœ€è¦æ³¨æ„é¿å…é‡å¤è®¡ç®—å’Œç³»æ•°ï¼Œæ‰€ä»¥åˆ†åˆ«æšä¸¾å‰ç¼€å’Œ `mu_sum`ã€`pow2` å’Œç´ æ•°æœ¬èº«ã€‚
4. æœ€åè¾“å‡ºç­”æ¡ˆã€‚

è¿™ä¸ªç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º $O(n^{1/2} \log n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n^{1/2})$ã€‚ %%
